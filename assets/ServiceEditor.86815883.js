import{_ as V,g as w,o as k,c as q,b as s,w as t,r as d}from"./index.8a6550d5.js";let c;const x={name:"ServiceEditor",setup(){c=w().appContext.config.globalProperties.$smkManager},data(){return{service:{name:"",type:"X64",summary:"",homepage:"",author:"",autostart:!1,location:"",enable:!0,requires:[],versionNum:"",versionType:"Release",service:""},smk_option:void 0,smk_props:{multiple:!0},serviceRule:{name:[{required:!0,message:"\u670D\u52A1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],type:[{required:!0,message:"\u670D\u52A1\u67B6\u6784\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],versionNum:[{required:!0,message:"\u670D\u52A1\u7248\u672C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],author:[{required:!0,message:"\u670D\u52A1\u5F00\u53D1\u5546\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],summary:[{required:!0,message:"\u670D\u52A1\u63CF\u8FF0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],homepage:[{required:!0,message:"\u670D\u52A1\u7EC4\u4EF6\u4E3B\u9875\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],location:[{required:!0,message:"\u670D\u52A1\u955C\u50CF\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],service:[{required:!0,message:"\u670D\u52A1\u7EC4\u4EF6\u5165\u53E3\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}},methods:{initSMK(){if(this.smk_option!=null)return;this.smk_option=new Array;let l=c.getSMK();if(l!=null&&l.meta!=null){for(let e in l.meta)if(l.meta[e].services!=null&&l.meta[e].services.length>0){let n={value:e,label:e},i=[];l.meta[e].services.forEach(r=>{let a=r.type+"-"+r.version;i.push({value:a,label:a})}),n.children=i,this.smk_option.push(n)}}},querySearchName(l,e){let n=new Set,i=c.getSMK();if(i!=null&&i.meta!=null)for(let r in i.meta)r.toLowerCase().indexOf(l.toLowerCase())!=-1&&n.add({value:r,link:r});e(Array.from(n))},querySearchVersion(l,e){let n=new Set,i=c.getSMK();i!=null&&i.meta!=null&&this.service.name in i.meta&&i.meta[this.service.name].services!=null&&i.meta[this.service.name].services.length>0&&i.meta[this.service.name].services.forEach(r=>{if(r.version.toLowerCase().indexOf(l.toLowerCase())!=-1){let a=r.version.substring(0,r.version.lastIndexOf("."));n.add({value:a,link:a})}}),e(Array.from(n))},querySearchAuthor(l,e){let n=new Set;this.initSMK();let i=c.getSMK();if(i!=null&&i.meta!=null)for(let r in i.meta)i.meta[r].services.forEach(a=>{a.author.toLowerCase().indexOf(l.toLowerCase())!=-1&&n.add({value:a.author,link:a.author})});e(Array.from(n))},setServiceInfo(l){if(l!=null){let e=this.covert2EditorService(l);console.log(e),e!=null&&(this.service=e)}},getServiceInfo(){return this.covert2SMKService()},covert2SMKService(){let l={},e=this.service;l.name=e.name,l.type=e.type,l.version=e.versionNum+"."+e.versionType,l.summary=e.summary,l.homepage=e.homepage,l.author=e.author,l.location=e.location,l.enable=e.enable,l.autostart=e.autostart,l.service=e.service;let n=new Set;return e.requires!=null&&e.requires.forEach(i=>{n.add(i.join("-"))}),l.requires=Array.from(n),l},covert2EditorService(l){if(!c.validService(l))return;let e={};e.name=l.name,e.type=l.type,e.versionNum=l.version.substring(0,l.version.lastIndexOf(".")),e.versionType=l.version.substring(l.version.lastIndexOf(".")+1),e.summary=l.summary,e.homepage=l.homepage,e.author=l.author,e.location=l.location,e.enable=l.enable,e.autostart=l.autostart,e.service=l.service;let n=new Array;return l.requires!=null&&l.requires.forEach(i=>{let r=i.indexOf("-");n.push([i.substring(0,r),i.substring(r+1)])}),e.requires=n,e},resetFields(){this.$refs.service.resetFields(),this.$refs.rs.panel.clearCheckedNodes()},check(l){this.$refs.service.validate(e=>{l(e)})}},mounted:function(){this.initSMK()},watch:{}},E={class:"s-item"};function C(l,e,n,i,r,a){const f=d("el-autocomplete"),u=d("el-form-item"),m=d("el-col"),v=d("el-option"),_=d("el-select"),p=d("el-row"),g=d("el-input"),h=d("el-cascader"),y=d("el-switch"),b=d("el-form");return k(),q("div",E,[s(b,{rules:r.serviceRule,model:r.service,ref:"service"},{default:t(()=>[s(p,null,{default:t(()=>[s(m,{span:5,class:"el-input-inline"},{default:t(()=>[s(u,{label:"\u670D\u52A1\u540D",class:"item",prop:"name"},{default:t(()=>[s(f,{modelValue:r.service.name,"onUpdate:modelValue":e[0]||(e[0]=o=>r.service.name=o),"fetch-suggestions":a.querySearchName,clearable:"",class:"inline-input w-50",placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u540D\u79F0"},null,8,["modelValue","fetch-suggestions"])]),_:1})]),_:1}),s(m,{span:5,class:"el-input-inline"},{default:t(()=>[s(u,{label:"\u670D\u52A1\u67B6\u6784",class:"item",prop:"type"},{default:t(()=>[s(_,{placeholder:"\u670D\u52A1\u67B6\u6784\u7C7B\u578B",modelValue:r.service.type,"onUpdate:modelValue":e[1]||(e[1]=o=>r.service.type=o)},{default:t(()=>[s(v,{label:"X64",value:"X64"}),s(v,{label:"X86",value:"X86"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),s(m,{span:6,class:"el-input-inline sv"},{default:t(()=>[s(u,{label:"\u670D\u52A1\u7248\u672C",class:"item",prop:"versionNum"},{default:t(()=>[s(f,{modelValue:r.service.versionNum,"onUpdate:modelValue":e[3]||(e[3]=o=>r.service.versionNum=o),"fetch-suggestions":a.querySearchVersion,class:"inline-input w-50",placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u7248\u672C"},{append:t(()=>[s(_,{placeholder:"\u7248\u672C\u7C7B\u578B",class:"el-sselect",modelValue:r.service.versionType,"onUpdate:modelValue":e[2]||(e[2]=o=>r.service.versionType=o)},{default:t(()=>[s(v,{label:"Release",value:"Release"}),s(v,{label:"Debug",value:"Debug"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","fetch-suggestions"])]),_:1})]),_:1}),s(m,{span:5,class:"el-input-inline"},{default:t(()=>[s(u,{label:"\u5F00\u53D1\u5546",class:"item",prop:"author"},{default:t(()=>[s(f,{modelValue:r.service.author,"onUpdate:modelValue":e[4]||(e[4]=o=>r.service.author=o),"fetch-suggestions":a.querySearchAuthor,class:"inline-input w-50",placeholder:"\u8BF7\u8F93\u5165\u5F00\u53D1\u5546\u540D\u79F0"},null,8,["modelValue","fetch-suggestions"])]),_:1})]),_:1})]),_:1}),s(p,null,{default:t(()=>[s(m,{span:22,class:"el-input-inline"},{default:t(()=>[s(u,{label:"\u670D\u52A1\u63CF\u8FF0",class:"item",prop:"summary"},{default:t(()=>[s(g,{rows:2,type:"textarea",maxlength:"100","show-word-limit":"",placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u7EC4\u4EF6\u63CF\u8FF0",modelValue:r.service.summary,"onUpdate:modelValue":e[5]||(e[5]=o=>r.service.summary=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(p,null,{default:t(()=>[s(m,{span:22,class:"el-input-inline"},{default:t(()=>[s(u,{label:"\u670D\u52A1\u7EC4\u4EF6\u4E3B\u9875",class:"item",prop:"homepage"},{default:t(()=>[s(g,{placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u7EC4\u4EF6\u4E3B\u9875",clearable:"",modelValue:r.service.homepage,"onUpdate:modelValue":e[6]||(e[6]=o=>r.service.homepage=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(p,null,{default:t(()=>[s(m,{span:22,class:"el-input-inline"},{default:t(()=>[s(u,{label:"\u670D\u52A1\u955C\u50CF\u5730\u5740",class:"item",prop:"location"},{default:t(()=>[s(g,{placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u955C\u50CF\u5730\u5740",clearable:"",modelValue:r.service.location,"onUpdate:modelValue":e[7]||(e[7]=o=>r.service.location=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(p,null,{default:t(()=>[s(m,{span:24,class:"el-input-inline"},{default:t(()=>[s(u,{label:"\u670D\u52A1\u4F9D\u8D56\u9879",class:"item"},{default:t(()=>[s(h,{options:r.smk_option,props:r.smk_props,clearable:"",ref:"rs",modelValue:r.service.requires,"onUpdate:modelValue":e[8]||(e[8]=o=>r.service.requires=o),placeholder:"\u9009\u62E9\u670D\u52A1\u4F9D\u8D56\uFF08\u975E\u5FC5\u987B\uFF09"},null,8,["options","props","modelValue"])]),_:1})]),_:1})]),_:1}),s(p,null,{default:t(()=>[s(m,{span:5,class:"el-input-inline"},{default:t(()=>[s(u,{label:"\u7EC4\u4EF6\u5165\u53E3",class:"item",prop:"service"},{default:t(()=>[s(f,{modelValue:r.service.service,"onUpdate:modelValue":e[9]||(e[9]=o=>r.service.service=o),clearable:"",class:"inline-input w-50",placeholder:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u5165\u53E3\u5E93"},null,8,["modelValue"])]),_:1})]),_:1}),s(m,{span:18,class:"el-input-inline"},{default:t(()=>[s(u,{label:"\u670D\u52A1\u81EA\u542F\u52A8",class:"item"},{default:t(()=>[s(y,{style:{top:"5px"},modelValue:r.service.autostart,"onUpdate:modelValue":e[10]||(e[10]=o=>r.service.autostart=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])])}const U=V(x,[["render",C]]);export{U as S};
